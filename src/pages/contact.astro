---
import Layout from "../layouts/Layout.astro";
import ContactForm from "../components/interactive/ContactForm";
import DynamicIcon from "../components/ui/DynamicIcon";
import { getEntry } from 'astro:content';

// Fetch endpoints from your contact.md
const entry = await getEntry('contact', 'contact');
const { endpoints } = entry?.data;
---

<Layout title="Network_Handshake">
  <div class="max-w-6xl mx-auto py-10 px-4">
    <!-- Header -->
    <div class="mb-20 fade-in">
      <div class="relative mb-6 border-b border-emerald-500/20 pb-6">
        <h1 class="text-3xl font-bold tracking-tighter text-slate-100 uppercase">
          <span class="text-emerald-500 font-mono font-medium mr-2">[0x04]</span>
          <span class="font-mono font-medium">CONTACT_PROTOCOL</span>
        </h1>
        <p class="font-mono text-[10px] text-slate-500 mt-2 uppercase tracking-widest">
          Status: <span class="text-emerald-400">Active</span> | 
          Channels: <span class="text-emerald-400">{endpoints.length}</span> | 
          Mode: <span class="text-emerald-400">Secure</span>
        </p>
      </div>
    </div>

    <!-- Contact Icons -->
    <div class="mb-12 fade-in flex flex-col items-center" style="--delay: 0.2s">
      <h2 class="font-mono text-xs text-slate-400 mb-6 flex items-center gap-2 uppercase tracking-wider">
        <span class="w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span> 
        Direct_Channels
      </h2>
      <div class="flex gap-6 flex-wrap justify-center">
        {endpoints.map((link: any, index: number) => (
          <a 
            href={link.href} 
            target="_blank" 
            class="relative group contact-icon"
            style={`--delay: ${0.3 + index * 0.1}s`}
          >
            {/* Glow effect background */}
            <div class="absolute -inset-2 bg-emerald-500/20 blur-xl opacity-0 group-hover:opacity-100 transition-opacity duration-500 rounded-xl"></div>
            
            {/* Icon container */}
            <div class="relative w-24 h-24 flex items-center justify-center border border-slate-700 bg-gradient-to-br from-slate-800 to-slate-900 hover:border-emerald-500/70 hover:from-emerald-500/20 hover:to-slate-800 text-slate-400 hover:text-emerald-300 transition-all duration-500 rounded-xl hover:scale-110 hover:shadow-[0_0_30px_rgba(16,185,129,0.4)] backdrop-blur-sm group-hover:rotate-3">
              {/* Corner decorations */}
              <div class="absolute top-0 left-0 w-3 h-3 border-t-2 border-l-2 border-emerald-500/50 group-hover:border-emerald-400 transition-colors duration-300"></div>
              <div class="absolute top-0 right-0 w-3 h-3 border-t-2 border-r-2 border-emerald-500/50 group-hover:border-emerald-400 transition-colors duration-300"></div>
              <div class="absolute bottom-0 left-0 w-3 h-3 border-b-2 border-l-2 border-emerald-500/50 group-hover:border-emerald-400 transition-colors duration-300"></div>
              <div class="absolute bottom-0 right-0 w-3 h-3 border-b-2 border-r-2 border-emerald-500/50 group-hover:border-emerald-400 transition-colors duration-300"></div>
              
              {/* Icon */}
              <div class="relative z-10 group-hover:scale-110 transition-transform duration-300">
                <DynamicIcon name={link.icon} size={32} client:load />
              </div>
              
              {/* Subtle grid pattern overlay */}
              <div class="absolute inset-0 opacity-5 group-hover:opacity-10 transition-opacity" style="background-image: radial-gradient(circle, currentColor 1px, transparent 1px); background-size: 8px 8px;"></div>
            </div>
            
            {/* Enhanced tooltip */}
            <div class="absolute left-1/2 -translate-x-1/2 bottom-full mb-4 px-5 py-3 bg-gradient-to-br from-slate-800 to-slate-900 border border-emerald-500/60 opacity-0 group-hover:opacity-100 pointer-events-none transition-all duration-300 whitespace-nowrap z-20 rounded-lg shadow-[0_0_20px_rgba(16,185,129,0.4)]">
              <div class="font-mono text-[9px] text-emerald-400 uppercase tracking-widest mb-1">{link.label}</div>
              <div class="text-xs text-slate-100 font-mono font-medium">{link.value}</div>
              <div class="absolute -bottom-1.5 left-1/2 -translate-x-1/2 w-3 h-3 bg-gradient-to-br from-slate-800 to-slate-900 border-b border-r border-emerald-500/60 rotate-45"></div>
            </div>
          </a>
        ))}
      </div>
    </div>

    <!-- Contact Form -->
    <div class="max-w-3xl mx-auto fade-in" style="--delay: 0.5s">
       <ContactForm client:load />
    </div>
  </div>
</Layout>

<style>
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .fade-in {
    animation: fadeInUp 0.8s ease-out forwards;
    animation-delay: var(--delay, 0s);
    opacity: 0;
  }

  .contact-icon {
    animation: fadeInUp 0.6s ease-out forwards;
    animation-delay: var(--delay, 0s);
    opacity: 0;
  }
</style>